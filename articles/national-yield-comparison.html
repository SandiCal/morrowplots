<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="morrowplots">
<title>National Yield Comparison • morrowplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="National Yield Comparison">
<meta property="og:description" content="morrowplots">
<meta property="og:image" content="https://SandiCal.github.io/morrowplots/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">morrowplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to the Morrow Plots</a>
    <a class="dropdown-item" href="../articles/morrow-plots-data-visualizations.html">Morrow Plots Data Visualizations</a>
    <a class="dropdown-item" href="../articles/national-yield-comparison.html">National Yield Comparison</a>
    <a class="dropdown-item" href="../articles/plots-etcetera.html">Plots Etcetera</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>National Yield Comparison</h1>
            
      
      
      <div class="d-none name"><code>national-yield-comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="how-do-corn-yields-at-the-morrow-plots-compare-to-the-national-average">How do corn yields at the Morrow Plots compare to the national
average?<a class="anchor" aria-label="anchor" href="#how-do-corn-yields-at-the-morrow-plots-compare-to-the-national-average"></a>
</h2>
<p>This exercise demonstrates how to use ggplot2 to create a graph
comparing corn yields on the Morrow Plots to the U.S. national average.
We’ll use the data from the morrowplots R package, and we’ll also import
national average data from the National Agricultural Statistics Service
(NASS).</p>
<p>In addition to the morrowplots package, this exercise also uses the
dplyr and ggplot2 packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sandical.github.io/morrowplots/" class="external-link">morrowplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="visualize-the-morrow-plots-data">1. Visualize the Morrow Plots data<a class="anchor" aria-label="anchor" href="#visualize-the-morrow-plots-data"></a>
</h2>
<p>First, let’s take a look at the Morrow Plots data so you can see what
we’re working with.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">morrowplots</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 26</span></span></span>
<span><span class="co">#&gt;   phase  year plot  plot_num plot_dir rotation corn  crop  variety      all_corn</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1  <span style="text-decoration: underline;">1</span>888 3NA          3 NW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1  <span style="text-decoration: underline;">1</span>888 3NB          3 NW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1  <span style="text-decoration: underline;">1</span>888 3NC          3 NE              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1  <span style="text-decoration: underline;">1</span>888 3ND          3 NE              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1  <span style="text-decoration: underline;">1</span>888 3SA          3 SW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1  <span style="text-decoration: underline;">1</span>888 3SB          3 SW              1 TRUE  CC    Burr's White FALSE   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more variables: yield_bush &lt;dbl&gt;, yield_ton &lt;dbl&gt;, treated &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   treatment &lt;chr&gt;, manure &lt;dbl&gt;, lime &lt;dbl&gt;, nit &lt;dbl&gt;, p205 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   k20 &lt;dbl&gt;, stover &lt;dbl&gt;, population &lt;dbl&gt;, plant_date &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   plant_day &lt;dbl&gt;, soil_sample &lt;lgl&gt;, damage &lt;chr&gt;, notes &lt;chr&gt;</span></span></span></code></pre></div>
<p><br></p>
<p><strong>1.1 Import and subset the Morrow Plots data</strong></p>
<p>We’ll be visualizing the corn yield data in the ‘yield_bush’
variable, but before we can compare corn yields, we need to narrow down
the dataset. Plots 4 and 5 grow corn every 2 to 3 years, but plot 3
grows corn every year. For the purposes of this exercise, we’ll create a
new subset of data from plot 3 only, but you could repeat these steps
with Plots 4 and 5.</p>
<p>We also have a few years where ‘yield_bush’ data is missing and
marked with ‘NA’. We can filter those out too so they don’t show up in
our visualizations.</p>
<p>If you look at the Morrow Plots data, you’ll see that each plot has
multiple rows of data for each year. That’s because each plot has
subplots. Some subplots receive fertility treatments and some don’t.
This is recorded in the TRUE/FALSE ‘treated’ variable. For our purposes,
we want the annual average yield, and because treatments affect yield,
we’ll calculate two annual averages - one for treated subplots and one
for untreated subplots. None of the subplots received treatments from
1888 to 1903, so those years will only have one average for untreated
subplots.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## name the new dataset mp3 for plot 3</span></span>
<span><span class="va">mp3</span> <span class="op">&lt;-</span> </span>
<span>  </span>
<span>  <span class="co">## filter to only include rows where 'plot_num' is 3 and 'yield_bush' is not 'NA'</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">morrowplots</span>, <span class="va">plot_num</span> <span class="op">==</span> <span class="fl">3</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yield_bush</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span></span>
<span>  <span class="co">## condense the filtered data and group it first by 'year' and then by 'treated'</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">treated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span></span>
<span>  <span class="co">## calculate the average 'yield_bush' for each grouping</span></span>
<span>  <span class="co">## and put that average in a new field called 'mp_ave'</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mp_ave <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">yield_bush</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'year'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mp3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   year [6]</span></span></span>
<span><span class="co">#&gt;    year treated mp_ave</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>888 FALSE     54.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>889 FALSE     43.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>890 FALSE     48.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>891 FALSE     28.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>892 FALSE     33.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>893 FALSE     21.7</span></span></code></pre></div>
<p><br></p>
<p><strong>1.2 Create a line graph for plot 3</strong></p>
<p>Now you should have a dataset called ‘mp3’ in your R environment,
which contains annual averages for treated and untreated corn in plot
3.</p>
<p>We can visualize the plot 3 yields in a line graph with ‘year’ on the
x axis and ‘mp_ave’ on the y axis. We’ll use the ‘treated’ variable to
plot treated and untreated corn with different colors.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mp3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">mp_ave</span>, color <span class="op">=</span> <span class="va">treated</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="national-yield-comparison_files/figure-html/mp3%20line-1.png" width="672"></p>
<p><br></p>
<p><strong>1.3 Smooth out the line graph</strong></p>
<p>Those lines are all over the place! So much so that it’s kind of hard
to read.</p>
<p>Try the same parameters with geom_smooth() instead, which creates
trend lines that makes it easier to view long-term trends in varied
data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mp3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">mp_ave</span>, color <span class="op">=</span> <span class="va">treated</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="national-yield-comparison_files/figure-html/mp3%20smooth-1.png" width="672"></p>
<p><br></p>
<p>Much smoother! Notice how the axes of the two graphs differ. R
automatically adjusts axes, so keep that in mind when comparing
graphs.</p>
<p>Now that we know what the corn yield trends from plot 3 look like, we
can add in national averages for comparison.</p>
</div>
<div class="section level2">
<h2 id="get-yield-data-from-nass">2. Get yield data from NASS<a class="anchor" aria-label="anchor" href="#get-yield-data-from-nass"></a>
</h2>
<p>For this exercise, we’re using data downloaded from the NASS website.
(Alternatively, you could use the NASS API to import data directly into
R, but that requires registration. For our purposes, working from a file
is easier.)</p>
<p><strong>2.1 Combine NASS and mp3 data (choose 1 option)</strong></p>
<p>You have two options for NASS data. You can either use this as an
opportunity to learn how to use NASS and download the data yourself, or
you can use the copy that’s saved in the morrowplots GitHub
repository.</p>
<p><strong>Option 1: Download NASS data yourself</strong></p>
<p>To download the NASS data, go to the <a href="https://quickstats.nass.usda.gov/" class="external-link">NASS Quick Stats webpage</a>
and follow the steps in the video below.</p>
<iframe id="kmsembed-1_l2vy5yng" width="640" height="394" src="https://mediaspace.illinois.edu/embed/secure/iframe/entryId/1_l2vy5yng/uiConfId/26883701/st/0" class="kmsembed" allowfullscreen webkitallowfullscreen mozallowfullscreen allow="autoplay *; fullscreen *; encrypted-media *" referrerpolicy="no-referrer-when-downgrade" sandbox="allow-downloads allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="How to Download NASS Data">
</iframe>
<p><br></p>
<p>NASS will give your file a super long name, so rename it
“NASS_data.csv” instead. Then you can import it into need to make sure R
knows where to find it, which you can do in one of two ways:</p>
<ol style="list-style-type: decimal">
<li><p>You can move the NASS file to your working directory. In your R
console, use getwd() to identify your working directory and then
manually move the file to that folder. In the code below, replace the
URL with your file name.</p></li>
<li><p>Or, you can add a file path to read.csv() to tell R where the
file is. In your R console, use file.choose(), which will pull up a
window that will let you navigate to your NASS file. R will print your
file path, which you can then add to the read.csv() code below. For
guidance, see this <a href="https://www.statology.org/r-file-choose/" class="external-link">step-by-step
example</a>.</p></li>
</ol>
<p><br></p>
<p><strong>Option 2: Get NASS data from GitHub</strong></p>
<p>If you feel like you already have plenty of work to do and don’t want
to learn how to use NASS, that’s ok. You can use the copy of the NASS
data that’s in the morrowplots GitHub repository.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## If you chose Option 1: Download NASS data yourself, replace the URL with your file name, and path if necessary</span></span>
<span><span class="va">NASS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://github.com/SandiCal/morrowplots/raw/main/vignettes/NASS_data.csv"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><strong>2.2 Combine NASS and mp3 data</strong></p>
<p>The NASS data contains a whole bunch of stuff we don’t need, so first
we’ll pare it down to just ‘Year’ and ‘Value’. While we’re doing that,
we’ll also rename the NASS variables. We’ll change ‘Year’ to ‘year’ so
it matches the variable in mp3 exactly (we need that for the next step),
and we’ll change ‘Value’ to ‘nat_ave’ for national average.</p>
<p>Once NASS is pared down, we’ll add the ‘nat_ave’ variable to the mp3
dataset and match the data up by ‘year’.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## remove everything from NASS except 'Year' and 'Value'</span></span>
<span><span class="va">NASS</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">NASS</span>, year <span class="op">=</span> <span class="va">Year</span>, nat_ave <span class="op">=</span> <span class="va">Value</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## join mp3 and NASS data by 'year'</span></span>
<span><span class="va">mp3_NASS</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">mp3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">NASS</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mp3_NASS</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   year [6]</span></span></span>
<span><span class="co">#&gt;    year treated mp_ave nat_ave</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>888 FALSE     54.3    29.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>889 FALSE     43.2    29.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>890 FALSE     48.7    22.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>891 FALSE     28.6    29.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>892 FALSE     33.1    24.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>893 FALSE     21.7    23.8</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="add-national-data-to-the-morrow-plots-graph">3. Add national data to the Morrow Plots graph<a class="anchor" aria-label="anchor" href="#add-national-data-to-the-morrow-plots-graph"></a>
</h2>
<p>You should now have NASS and mp3_NASS datasets in your R
environment.</p>
<p><br></p>
<p><strong>3.1 Plotting the combined data</strong></p>
<p>We can now recreate our geom_smooth graph from above using the
mp3_NASS data, and add a black dashed line to show the national
average.</p>
<p>Since this is our final graph, we can also add a title and subtitle
to provide context, and a built-in theme to change the look of the
graph.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mp3_NASS</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## mp_ave color coded by 'treated'</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">mp_ave</span>, color <span class="op">=</span> <span class="va">treated</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add nat_ave as a dashed black line in the same graph</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">nat_ave</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add title and subtitle</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Morrow Plots Continuous Corn Yield Trends in Bushels per Acre"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Compared to the U.S. national average (dashed line)"</span></span>
<span>       <span class="op">)</span><span class="op">+</span></span>
<span>  </span>
<span>  <span class="co">## add one of the built-in themes</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="national-yield-comparison_files/figure-html/plot%20both-1.png" width="672"></p>
<p><br></p>
<p><strong>3.2 Interpreting the Results</strong></p>
<p>Now that you have a combined graph, how do the data compare?</p>
<p>The untreated continuous corn (that’s where corn is grown every
single year with no fertility treatments) starts out performing slightly
better than the national average, but begins to dip over time as the
untreated soil is depleted. Even so, Illinois soil is so rich that the
untreated corn is pretty similar to the national average until the late
1930’s when the national average starts to rise up and break away. Why
is that? One reason is that around that time, hybrid corn was
introduced, and it performed better than previously popular corn breeds.
Hybrid corn was introduced into the Morrow Plots in 1937, which is one
reason why we see both the treated and untreated yields start to rise
after that.</p>
<p>The treated continuous corn rises a lot higher than the untreated
yields, but why does it eventually plateau while the national average
keeps rising? One reason is the other major variable in the Morrow Plots
experiment - crop rotation. Planting corn year after year eventually
depletes the soil, even when the soil is treated. This graph only
includes data from continuous corn. If you repeat these steps with corn
yields from Plot 4 or 5, both of which rotate corn with other crops,
you’d see that those plots perform better over the long term.</p>
<p>You did it! You combined datasets and graphs, plus you bothered to
read through the interpretation, which proves you really care about
data. Well done!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sandi Caldrone, Heidi Imker, Josh Henry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
